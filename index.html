<!DOCTYPE html>
<html lang="hr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>QR RAČUNATOR</title>
  <!-- PWA Manifest Link -->
  <link rel="manifest" href="manifest.json">
  <meta name="google-site-verification" content="MiNsi-1k4TYmSbTNGPDs_lsgTyiVKmxEa4nkihpTB1s" />
  <meta property="og:title" content="QR RAČUNATOR" />
  <meta property="og:description" content="Web aplikacija za skeniranje QR kodova s Hrvatskih fiskalnih računa i automatsko zbrajanje iznosa. Uključuje povijest i pretragu."/>
  <meta name="description" content="Web aplikacija za skeniranje QR kodova s Hrvatskih fiskalnih računa i automatsko zbrajanje iznosa. Uključuje povijest i pretragu.">
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://soboslikar.github.io/QR-RACUNATOR/" />
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
  <style>
    /* CSS (Sve prethodno + NOVI STILOVI ZA PWA I MODAL + NOVI STILOVI ZA POSLOŽI EKRAN) */
    body { font-family: sans-serif; margin: 0; padding: 0.5em; background: #f4f4f4; overflow-x: hidden; min-height: 100vh; }
    body.scanner-view #history-page, body.scanner-view #ads-page, body.scanner-view #sort-session-page { display: none; } /* Dodano #sort-session-page */
    body.history-view { background-color: white; }
    body.ads-view { background-color: #f0f2f5; }
    body.sort-session-view { background-color: white; } /* Novi stil za sort-session-view */

    body.history-view #history-page, body.ads-view #ads-page, body.sort-session-view #sort-session-page {
        display: flex;
        flex-direction: column;
        padding: 0;
        min-height: calc(100vh - 1em);
        max-height: calc(100vh - 1em);
        box-sizing: border-box;
        overflow: hidden;
    }
    
    body.fullscreen-modal-open { overflow: hidden; }

    /* Sakrij SVE elemente skenera kad smo u history, ads ili sort-session view */
    body.history-view #header, body.history-view #scan-instruction, body.history-view #reader, body.history-view #loaded-message, body.history-view #duplicate-warning, body.history-view #total-container, body.history-view #session-name-container, body.history-view #invoice-count, body.history-view #history, body.history-view #remove-from-list-btn, body.history-view #history-toggle-btn, body.history-view #share-button, body.history-view #delete-warning, body.history-view #running-text-container, body.history-view #share-prompt-overlay, body.history-view #counter-deactivated-indicator,
    body.history-view #switch-camera-btn, body.history-view #camera-selection-overlay,
    body.history-view #manual-entry-modal-overlay,
    body.ads-view #header, body.ads-view #scan-instruction, body.ads-view #reader, body.ads-view #loaded-message, body.ads-view #duplicate-warning, body.ads-view #total-container, body.ads-view #session-name-container, body.ads-view #invoice-count, body.ads-view #history, body.ads-view #remove-from-list-btn, body.ads-view #history-toggle-btn, body.ads-view #share-button, body.ads-view #delete-warning, body.ads-view #running-text-container, body.ads-view #share-prompt-overlay, body.ads-view #counter-deactivated-indicator,
    body.ads-view #switch-camera-btn, body.ads-view #camera-selection-overlay,
    body.ads-view #manual-entry-modal-overlay,
    body.sort-session-view #header, body.sort-session-view #scan-instruction, body.sort-session-view #reader, body.sort-session-view #loaded-message, body.sort-session-view #duplicate-warning, body.sort-session-view #total-container, body.sort-session-view #session-name-container, body.sort-session-view #invoice-count, body.sort-session-view #history, body.sort-session-view #remove-from-list-btn, body.sort-session-view #history-toggle-btn, body.sort-session-view #share-button, body.sort-session-view #delete-warning, body.sort-session-view #running-text-container, body.sort-session-view #share-prompt-overlay, body.sort-session-view #counter-deactivated-indicator,
    body.sort-session-view #switch-camera-btn, body.sort-session-view #camera-selection-overlay,
    body.sort-session-view #manual-entry-modal-overlay
    {
        display: none !important;
    }

    #header { text-align: center; color: yellow; font-size: 1.2em; font-weight: bold; margin-bottom: 0.5em; position: absolute; width: 100%; left: 0; top: 1em; z-index: 3; text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7); }
    #scan-instruction { position: absolute; top: 2.8em; left: 50%; transform: translateX(-50%); width: 90%; text-align: center; color: white; font-size: 1em; font-weight: bold; z-index: 2; text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8); pointer-events: none; display: block; }
    #reader { width: 100%; max-width: 400px; margin: auto; height: 55vh; position: relative; border: 1px solid #ccc; background: #e0e0e0; }
    
    #total-container { position: fixed; top: 23.5em; left: 50%; transform: translateX(-50%); z-index: 6; display: flex; align-items: center; gap: 10px; background-color: rgba(0, 0, 0, 0.5); padding: 0.2em 0.5em; border-radius: 5px; }
    #total { font-size: 1.6em !important; font-weight: bold; color: yellow; text-align: center; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); }
    
    #action-buttons-wrapper {
        display: flex;
        flex-direction: column;
        gap: 10px;
        align-items: center;
    }
    #ads-button, #install-pwa-btn {
        width: 100%;
        box-sizing: border-box;
        color: white;
        font-weight: bold;
        font-size: 1.2em;
        padding: 0.6em 1.2em;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
        animation: pulse-ads 1.5s ease-in-out infinite;
        display: none;
        white-space: nowrap;
    }
    #ads-button { background-color: #1e7e34; }
    #install-pwa-btn { background-color: #007bff; }

    #ads-button:active, #install-pwa-btn:active {
        box-shadow: inset 0 2px 4px rgba(0,0,0,0.4);
        animation: none;
    }
    @keyframes pulse-ads {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }

    #ocisti-button { padding: 0; width: 120px; height: 60px; font-size: 0.9em; font-weight: bold; background: #ff0000; color: yellow; display: none; line-height: 1.3; text-align: center; border-radius: 5px; margin-left: 20px; }
    #ocisti-button:active { box-shadow: inset 0 1px 2px rgba(0,0,0,0.3); }
    #ocisti-button.confirm-mode { background-color: yellow; color: black; }

    #session-name-container { position: fixed; top: 27.5em; left: 50%; transform: translateX(-50%); z-index: 5; display: flex; align-items: center; width: 95%; max-width: 400px; justify-content: space-between; min-height: 35px; text-align: center; margin-top: 10px; background-color: rgba(0, 0, 0, 0.5); padding: 0.2em 0.5em; border-radius: 5px; gap: 15px; }
    #session-name-wrapper { display: flex; align-items: center; gap: 8px; flex-shrink: 1; min-width: 0; flex-grow: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; margin-left: 5px; }
    #add-name-btn { padding: 0.4em 0.8em; font-size: 0.9em; background-color: #e0e0e0; color: black; display: block; flex-shrink: 0; font-weight: bold; white-space: nowrap; }
    #session-name-input { font-size: 1.2em; padding: 0.3em 0.5em; border: 1px solid #ccc; border-radius: 4px; width: 100%; display: none; box-sizing: border-box; flex-grow: 1; }
    #session-name-display { font-size: 1em; font-weight: bold; color: yellow; background-color: rgba(0, 0, 0, 0.5); padding: 0.3em 0.8em; border-radius: 5px; display: none; align-items: center; gap: 8px; flex-grow: 1; min-width: 50px; text-align: left; box-sizing: border-box; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    #session-name-display .edit-icon { cursor: pointer; font-size: 0.8em; font-weight: normal; color: white; text-decoration: underline; flex-shrink: 0; }
    #manual-entry-btn { background-color: orange; color: black; padding: 0.4em 0.8em; font-size: 0.9em; font-weight: bold; border: none; border-radius: 5px; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.2); text-align: center; line-height: 1.3; flex-shrink: 0; min-width: 90px; white-space: nowrap; margin-right: 5px; }
    #invoice-count { font-size: 1.4em; color: black; padding: 0.1em 0.4em; position: fixed; bottom: 170px; right: 50px; z-index: 2; text-align: right; font-weight: bold; }
    #duplicate-warning { font-weight: bold; color: red; background-color: rgba(255, 255, 255, 0.8); padding: 0.3em 0.8em; border-radius: 5px; border: 1px solid red; text-align: center; animation: pulse 0.5s ease-in-out 3 alternate; position: fixed; top: 12.8em; left: 50%; transform: translateX(-50%); z-index: 5; display: none; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
    #loaded-message { font-weight: bold; color: green; display: none; text-align: center; font-size: 2em; position: fixed; top: 30%; left: 50%; transform: translate(-50%, -50%); animation: zoomFade 1s ease-out; z-index: 10; background-color: rgba(255, 255, 255, 0.85); padding: 0.8em 2em; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,4,8,0.2); }
    #delete-warning { font-weight: bold; display: none; text-align: center; position: fixed; top: 21.5em; left: 50%; transform: translateX(-50%); padding: 0.3em 0.6em; border-radius: 3px; z-index: 5; box-shadow: 0 1px 2px rgba(0,0,0,0.2); white-space: nowrap; }
    #delete-warning.delete-mode { color: black; background-color: rgba(255, 255, 0, 0.8); }
    #delete-warning.info-mode { color: white; background-color: rgba(0, 0, 0, 0.6); border: none; box-shadow: 0 1px 2px rgba(0,0,0,0.4); }
    #history { max-height: 180px; overflow-y: auto; margin: 0; padding: 1em; background: white; border-radius: 5px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); width: 150px; position: fixed; bottom: 10px; left: 10px; z-index: 1; display: block; }
    #history ul { list-style: none; padding: 0; margin: 0; }
    #history li { padding: 0.5em 0; border-bottom: 1px solid #eee; white-space: pre; font-weight: bold; overflow: hidden; text-overflow: ellipsis; font-size: 1em; }
    #history li:last-child { border-bottom: none; }
    button { padding: 0.5em 1em; font-size: 1em; border: none; border-radius: 5px; color: black; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
    button:active { box-shadow: inset 0 1px 2px rgba(0,0,0,0.3); }
    .red-btn { background: #ff0000; color: yellow; }
    .yellow-btn { background-color: yellow; color: black; }
    #remove-from-list-btn { position: fixed; bottom: 130px; right: 50px; z-index: 3; }
    #history-toggle-btn { position: fixed; bottom: 80px; right: 50px; z-index: 3; background-color: white; color: blue; font-weight: bold; }
    #sort-session-btn { /* NOVI GUMB POSLOŽI */
        position: fixed;
        bottom: 80px;
        right: 50px;
        z-index: 3;
        background-color: orange; /* Narančasta boja */
        color: black;
        font-weight: bold;
        padding: 0.5em 1em;
        font-size: 1em;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        display: none; /* Inicijalno skriven */
        animation: pulse-orange 1.5s ease-in-out infinite; /* Animacija pulsiranja */
    }
    #sort-session-btn:active {
        box-shadow: inset 0 1px 2px rgba(0,0,0,0.3);
        animation: none;
    }
    @keyframes pulse-orange { /* Animacija pulsiranja boje */
        0% { background-color: orange; }
        50% { background-color: #ffc107; } /* Svjetlija narančasta/žuta */
        100% { background-color: orange; }
    }

    #share-button { position: fixed; bottom: 30px; right: 15px; z-index: 3; background-color: green; color: white; padding: 0.5em 1em; font-size: 1em; border: none; border-radius: 5px; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.2); font-weight: bold; animation: pulse-share 1.5s ease-in-out infinite; }
    #share-button:active { box-shadow: inset 0 1px 2px rgba(0,0,0,0.3); animation: none; }
    #history-page, #ads-page, #sort-session-page { display: none; } /* Dodano #sort-session-page */

    #pwa-install-modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); z-index: 300; display: none; justify-content: center; align-items: center; }
    #pwa-install-modal-content { background-color: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); max-width: 90%; width: 320px; text-align: center; }
    #pwa-install-modal-content h3 { margin-top: 0; color: #333; font-size: 1.3em; }
    #pwa-install-modal-content p { color: #555; line-height: 1.5; margin-bottom: 25px; }
    #pwa-install-modal-buttons { display: flex; flex-direction: column; gap: 10px; }
    #pwa-install-modal-buttons button { padding: 12px 15px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1em; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
    #pwa-install-confirm-btn { background-color: #007bff; color: white; }
    #pwa-install-later-btn { background-color: #6c757d; color: white; }
    #pwa-install-never-btn { background: none; box-shadow: none; color: #888; text-decoration: underline; font-size: 0.9em; padding-top: 5px; }

    #history-sticky-header, #ads-sticky-header, #sort-session-sticky-header { position: sticky; top: 0; z-index: 10; padding: 0.5em 1em; border-bottom: 1px solid #ccc; flex-shrink: 0; } /* Dodano #sort-session-sticky-header */
    #history-sticky-header { background-color: white; }
    #ads-sticky-header { background-color: #f9f9f9; }
    #sort-session-sticky-header { background-color: white; } /* Stil za sort-session-sticky-header */

    #history-header, #ads-header, #sort-session-header { display: flex; align-items: center; justify-content: space-between; } /* Dodano #sort-session-header */
    #history-header h1, #ads-header h1, #sort-session-header h1 { margin: 0; text-align: center; flex-grow: 1; font-size: 1.3em; } /* Dodano #sort-session-header h1 */
    #back-to-scanner-btn, #back-to-scanner-from-ads-btn, #back-to-scanner-from-sort-btn { background-color: green; color: white; border: none; font-weight: bold; margin: 0; padding: 0.4em 0.8em; font-size: 0.9em; cursor: pointer; } /* Dodano #back-to-scanner-from-sort-btn */
    #back-to-scanner-btn:active, #back-to-scanner-from-ads-btn:active, #back-to-scanner-from-sort-btn:active { background-color: darkgreen; } /* Dodano #back-to-scanner-from-sort-btn */
    #history-content, #ads-content, #sort-session-content { flex-grow: 1; overflow-y: auto; padding: 1em; position: relative; } /* Dodano #sort-session-content */

    /* Novi stilovi za listu računa u "POSLOŽI" ekranu */
    #sort-session-list { list-style: none; padding: 0; margin: 0; }
    #sort-session-list li {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.6em 0.2em;
        border-bottom: 1px solid #eee;
        font-size: 1.05em;
    }
    #sort-session-list li:last-child { border-bottom: none; }

    /* Novi stilovi za podnožje "POSLOŽI" ekrana */
    #sort-session-footer {
        position: sticky;
        bottom: 0;
        z-index: 10;
        padding: 0.8em 1em;
        border-top: 1px solid #ccc;
        background-color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-shrink: 0;
        gap: 10px;
    }
    #sort-session-footer-name-wrapper {
        display: flex;
        align-items: center;
        gap: 8px;
        flex-shrink: 1;
        min-width: 0;
        flex-grow: 1;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
    #sort-session-add-name-btn {
        padding: 0.4em 0.8em;
        font-size: 0.9em;
        background-color: #e0e0e0;
        color: black;
        display: block;
        flex-shrink: 0;
        font-weight: bold;
        white-space: nowrap;
    }
    #sort-session-name-input {
        font-size: 1.2em;
        padding: 0.3em 0.5em;
        border: 1px solid #ccc;
        border-radius: 4px;
        width: 100%;
        display: none;
        box-sizing: border-box;
        flex-grow: 1;
    }
    #sort-session-name-display {
        font-size: 1em;
        font-weight: bold;
        color: #333;
        background-color: #f0f0f0;
        padding: 0.3em 0.8em;
        border-radius: 5px;
        display: none;
        align-items: center;
        gap: 8px;
        flex-grow: 1;
        min-width: 50px;
        text-align: left;
        box-sizing: border-box;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
    #sort-session-name-display .edit-icon {
        cursor: pointer;
        font-size: 0.8em;
        font-weight: normal;
        color: #666;
        text-decoration: underline;
        flex-shrink: 0;
    }
    #sort-session-save-btn {
        background-color: green;
        color: white;
        padding: 0.6em 1.2em;
        font-size: 1.1em;
        font-weight: bold;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        flex-shrink: 0;
    }
    #sort-session-save-btn:active {
        box-shadow: inset 0 1px 2px rgba(0,0,0,0.3);
    }
    #sort-session-clear-all-btn {
        background-color: #ff0000;
        color: yellow;
        padding: 0.4em 0.8em;
        font-size: 0.9em;
        font-weight: bold;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        flex-shrink: 0;
    }
    #sort-session-clear-all-btn.confirm-mode {
        background-color: yellow;
        color: black;
    }


    .ad-card { border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .ad-title { font-size: 1.2em; font-weight: bold; text-align: center; margin-bottom: 10px; }
    .ad-gallery-container { position: relative; margin-bottom: 15px; user-select: none; background-color: #e0e0e0; min-height: 200px; display: flex; align-items: center; justify-content: center; overflow: hidden; }
    .ad-gallery-item { display: none; width: 100%; height: auto; max-height: 60vh; object-fit: contain; cursor: pointer; }
    .ad-gallery-item.is-iframe { height: 300px; }
    .ad-gallery-item.active { display: block; }
    .ad-gallery-nav { position: absolute; top: 50%; transform: translateY(-50%); background-color: rgba(0, 0, 0, 0.5); color: white; border: none; font-size: 1.8em; font-weight: bold; cursor: pointer; padding: 5px 10px; border-radius: 5px; z-index: 2; line-height: 1; }
    .ad-gallery-nav.prev { left: 5px; }
    .ad-gallery-nav.next { right: 5px; }
    .ad-gallery-counter { position: absolute; top: 8px; right: 8px; background-color: rgba(0, 0, 0, 0.6); color: white; padding: 3px 8px; font-size: 0.8em; border-radius: 10px; z-index: 2; }
    .ad-text { font-size: 1em; margin-bottom: 15px; line-height: 1.4; }
    .ad-contact-container { margin-bottom: 15px; }
    .ad-contact-container a { color: #00008B; text-decoration: none; font-weight: bold; font-size: 1.1em; }
    .ad-web-link-container { text-align: center; }
    .ad-web-link { display: inline-block; background-color: #007bff; color: white; padding: 10px 15px; border-radius: 5px; text-decoration: none; font-weight: bold; transition: background-color 0.2s; }
    .ad-web-link:hover { background-color: #0056b3; }
    #ads-footer-promo { text-align: center; margin-top: 20px; padding: 15px; font-size: 1.1em; font-weight: bold; color: #333; background-color: #f0f0f0; border-radius: 5px; }
    .ad-share-btn { display: inline-block; background-color: #28a745; color: white; padding: 10px 20px; margin-top: 15px; border-radius: 5px; text-decoration: none; font-weight: bold; text-align: center; cursor: pointer; border: none; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
    .ad-share-btn:hover { background-color: #218838; }

    #fullscreen-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.9); z-index: 200; display: none; justify-content: center; align-items: center; flex-direction: column; }
    #fullscreen-content { max-width: 98%; max-height: 90%; width: 100%; }
    #fullscreen-content img, #fullscreen-content video { width: 100%; height: 100%; object-fit: contain; }
    #fullscreen-content iframe { width: 100%; height: 80vh; border: none; }
    #fullscreen-close { position: absolute; top: 15px; right: 20px; font-size: 2.5em; color: white; font-weight: bold; cursor: pointer; z-index: 202; line-height: 1; }
    .fullscreen-nav { position: fixed; top: 50%; transform: translateY(-50%); background-color: rgba(0, 0, 0, 0.4); color: white; border: none; font-size: 3em; font-weight: bold; cursor: pointer; padding: 10px; border-radius: 5px; z-index: 201; line-height: 1; }
    .fullscreen-nav.prev { left: 10px; }
    .fullscreen-nav.next { right: 10px; }
    #fullscreen-counter { position: fixed; bottom: 15px; left: 50%; transform: translateX(-50%); background-color: rgba(0, 0, 0, 0.6); color: white; padding: 5px 12px; font-size: 1em; border-radius: 15px; z-index: 201; }
    
    #scan-group-list, #all-days-list-rendered, #search-results ul, #search-results-all-days ul { list-style: none; padding: 0; margin: 0; }
     #scan-group-list li, #all-days-list-rendered li, #search-results li, #search-results-all-days li { background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 4px; padding: 10px 12px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; transition: background-color 0.2s ease; }
     #scan-group-list li:hover, #all-days-list-rendered li:hover, #search-results li:hover, #search-results-all-days li:hover { background-color: #efefef; }
     .scan-group-last-qr-time { font-size: 0.8em; color: #777; margin-left: 15px; flex-shrink: 0; }
     .session-name-history { font-size: 1em; color: #00008B; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-weight: bold; }
     .scan-time-history { font-size: 1em; color: #333; white-space: nowrap; margin-left: 5px; }
     #clear-history-btn.confirm-mode, #delete-session-btn.confirm-mode, #clear-day-btn.confirm-mode { background-color: yellow; color: black; }
     #detail-scan-list { list-style: none; padding: 0; margin: 0; }
     #detail-scan-list li {display: flex; justify-content: space-between; align-items: center; padding: 0.6em 0.2em; border-bottom: 1px solid #eee; font-size: 1.05em;}
     #detail-scan-list li:last-child { border-bottom: none; }
     #all-days-search-container { background-color: white; padding: 0.5em 0; margin-bottom: 0.2em; }
     #all-days-search-container input { flex-grow: 1; padding: 0.5em; min-width: 50px; font-size: 0.9em; }
     #all-days-search-container button { padding: 0.5em 0.6em; font-size: 0.9em; flex-shrink: 0; }
     #search-container { display: none; padding: 1em 0; margin-bottom: 1em; }
     #search-container > div:first-child { display: flex; gap: 10px; margin-bottom: 0.8em; }
     #search-summary-info-day { display: none; justify-content: space-between; align-items: center; padding: 0.6em 0; font-size: 1.1em; margin-top: 0.8em; border-top: 1px solid #eee; }
     #all-days-list-rendered li { background-color: #f0f0f0; border: 1px solid #ccc; padding: 12px 15px; margin-bottom: 8px; }
     #all-days-list-rendered li:hover { background-color: #e0e0e0; }
     #all-days-summary-info, #history-date-info, #history-summary-info, #detail-header-info, #detail-summary-info, #search-summary-info-day, #all-days-search-container { padding: 0.6em 0; margin-bottom: 0.5em; border-top: 1px solid #eee; }
     #history-dynamic-header-content > *:first-child { border-top: none; padding-top: 0; }
     #all-days-summary-info, #search-summary-info-day { display: none; justify-content: space-between; align-items: center; font-size: 1.1em; }
     #history-date-info, #history-summary-info, #detail-summary-info { display: flex; justify-content: space-between; align-items: center; font-size: 1.1em; }
     #detail-header-info { display: flex; align-items: center; justify-content: space-between; padding-bottom: 0.5em; border-bottom: 1px solid #ccc; border-top: none; }
     #detail-summary-info { border-top: none; }
     #all-days-search-container { padding-bottom: 0.2em; border-bottom: 1px solid #eee; }
     #search-container { display: none; border-bottom: 1px solid #eee; }
     #running-text-container { position: absolute; top: 4.8em; left: 0; width: 100%; overflow: hidden; white-space: nowrap; z-index: 2; pointer-events: none; display: none; }
     #running-text-container span { display: inline-block; padding-left: 100%; font-size: 1.4em; font-weight: bold; color: yellow; text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8); animation: marquee 25s linear infinite; white-space: pre; }
     @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }
     #share-prompt-overlay { position: absolute; top: 7em; left: 50%; transform: translateX(-50%); width: 60%; height: auto; background-color: rgba(0, 0, 0, 0.75); color: lightgreen; font-size: 1.3em; font-weight: bold; text-align: center; padding: 1.5em 1em; border-radius: 10px; z-index: 4; display: none; box-shadow: 0 4px 8px rgba(0,0,0,0.3); line-height: 1.4; align-items: center; justify-content: center; }
     #counter-deactivated-indicator { position: fixed; top: 10px; left: 10px; font-size: 1em; color: limegreen; background-color: transparent; z-index: 5; display: none; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); }
     #switch-camera-btn { position: fixed; top: 10px; right: 10px; z-index: 5; padding: 6px 8px; background-color: #007bff; color: white; border: none; border-radius: 50%; font-size: 1.4em; line-height: 1; cursor: pointer; box-shadow: 0 1px 3px rgba(0,0,0,0.3); display: none; }
     #switch-camera-btn:active { background-color: rgba(0, 0, 0, 0.7); }
     #camera-selection-overlay { position: fixed; top: 55px; right: 10px; background-color: white; border: 1px solid #ccc; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 6; padding: 5px 0; display: none; max-height: 150px; overflow-y: auto; min-width: 150px; }
     #camera-list { list-style: none; padding: 0; margin: 0; }
     #camera-list li { padding: 8px 12px; cursor: pointer; font-size: 0.9em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
     #camera-list li:hover { background-color: #f0f0f0; }
     #camera-list li.selected-camera { font-weight: bold; background-color: #e0e0e0; }
     #manual-entry-modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); z-index: 100; display: none; justify-content: center; align-items: center; }
     #manual-entry-modal-content { background-color: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); max-width: 90%; width: 300px; text-align: center; }
     #manual-entry-modal-content input[type="text"] { width: calc(100% - 20px); padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 1em; box-sizing: border-box; }
     #manual-entry-modal-content label { display: block; margin-bottom: 5px; font-weight: bold; text-align: left; }
     #manual-entry-modal-content div { margin-bottom: 15px; text-align: left; }
     #manual-entry-modal-content div:last-child { margin-bottom: 0; text-align: center; }
     #manual-entry-modal-content button { padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 1em; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
     #manual-entry-modal-content button:active { box-shadow: inset 0 1px 2px rgba(0,0,0,0.3); }
     #manual-entry-modal-content button#manual-add-btn { background-color: green; color: white; }
     #manual-entry-modal-content button#manual-cancel-btn { background-color: #dc3545; color: white; }
     #manual-entry-error { color: red; font-size: 0.9em; margin-top: 10px; display: none; }
     #import-file-input { display: none; }
     @keyframes zoomFade { 0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; } 50% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; } 100% { transform: translate(-50%, -50%) scale(1); opacity: 0; } }
     @keyframes pulse-share { 0% { transform: scale(1); } 50% { transform: scale(1.08); } 100% { transform: scale(1); } }
  </style>
</head>
<body class="scanner-view">

  <div id="counter-deactivated-indicator" style="display: none;">✔</div>
  <div id="header">QR Skener-Kalkulator</div>
  <div id="scan-instruction">Pozicioniraj qr kod unutar kvadrata kamere</div>
  <div id="running-text-container" style="display: none;"><span></span></div>
  <div id="share-prompt-overlay" style="display: none;">KLIKNI ZELENI GUMB<br>I PODIJELI RAČUNATOR<br>PORUKA ĆE NESTATI</div>

  <div id="reader"></div>

  <button id="switch-camera-btn" style="display: none;">🔄</button>
  <div id="camera-selection-overlay" style="display: none;">
      <ul id="camera-list"></ul>
  </div>

  <div id="loaded-message" style="display: none;">UČITANO</div>
  <div id="duplicate-warning" style="display: none;">TAJ RAČUN JE URAČUNAT</div>

  <div id="total-container">
      <div id="total">UKUPNO: 0.00 €</div>
      <div id="action-buttons-wrapper">
          <button id="install-pwa-btn">INSTALIRAJ APLIKACIJU</button>
          <button id="ads-button"></button>
      </div>
      <button id="ocisti-button" onclick="startOcistiConfirm()" style="display: none;">SPREMI<br>I OČISTI</button>
  </div>

  <div id="session-name-container">
      <div id="session-name-wrapper">
          <button id="add-name-btn" onclick="startAddName()">DODAJ NAZIV</button>
          <input type="text" id="session-name-input" placeholder="Unesi naziv sesije..." maxlength="30">
          <span id="session-name-display">
              <span id="session-name-text"></span>
              <span class="edit-icon" onclick="startAddName()">Uredi</span>
          </span>
      </div>
      <button id="manual-entry-btn">SAM UPIŠI RAČ:</button>
  </div>

  <div id="invoice-count">0 RAČUNA</div>
  <div id="history" style="display: none;"> <ul id="historyList"></ul> </div>
  <button class="red-btn" id="remove-from-list-btn" onclick="startRemoveFromList()" style="display:none;">Obriši iz liste</button>
  <button id="history-toggle-btn">POVIJEST</button>
  <button id="sort-session-btn">POSLOŽI</button> <!-- NOVI GUMB -->
  <button id="share-button" style="display: none;">DIJELI RAČUNATOR</button>
  <div id="delete-warning" style="display: none;"></div>

  <div id="history-page">
      <div id="history-sticky-header">
          <div id="history-header"> <button id="back-to-scanner-btn">< NA SKENER</button> <h1>POVIJEST</h1> </div>
          <div id="history-dynamic-header-content"></div>
      </div>
      <div id="history-content"></div>
  </div>

  <div id="ads-page">
      <div id="ads-sticky-header">
          <div id="ads-header">
              <button id="back-to-scanner-from-ads-btn">< NA SKENER</button>
              <h1>PONUDE</h1>
          </div>
      </div>
      <div id="ads-content"></div>
  </div>

  <!-- NOVI EKRAN ZA POSLOŽI FUNKCIONALNOST -->
  <div id="sort-session-page">
      <div id="sort-session-sticky-header">
          <div id="sort-session-header">
              <button id="back-to-scanner-from-sort-btn">< NA SKENER</button>
              <h1>TRENUTNA SESIJA</h1>
              <button id="sort-session-clear-all-btn">OBRIŠI SVE</button>
          </div>
      </div>
      <div id="sort-session-content">
          <p style="text-align: center; color: grey; padding: 1em 0;"><i>Nema računa u trenutnoj sesiji.</i></p>
          <ul id="sort-session-list">
              <!-- Ovdje će se dinamički dodavati računi -->
          </ul>
      </div>
      <div id="sort-session-footer">
          <div id="sort-session-footer-name-wrapper">
              <button id="sort-session-add-name-btn">DODAJ NAZIV</button>
              <input type="text" id="sort-session-name-input" placeholder="Unesi naziv sesije..." maxlength="30">
              <span id="sort-session-name-display">
                  <span id="sort-session-name-text"></span>
                  <span class="edit-icon" onclick="startSortSessionAddName()">Uredi</span>
              </span>
          </div>
          <button id="sort-session-save-btn">SPREMI</button>
      </div>
  </div>

  <div id="manual-entry-modal-overlay" style="display: none;">
      <div id="manual-entry-modal-content">
          <h3 style="margin-top: 0; color: #333;">Ručni unos računa</h3>
          <div style="margin-bottom: 15px;">
              <label for="manual-amount-input">Iznos (€):</label>
              <input type="text" id="manual-amount-input" placeholder="npr. 15,99 ili 25.00">
          </div>
          <div style="margin-bottom: 20px;">
              <label for="manual-time-input">Vrijeme (HH:MM - opcionalno):</label>
              <input type="text" id="manual-time-input" placeholder="npr. 14:35" pattern="^([0-1]?\d|2[0-3]):([0-5]?\d)$">
          </div>
          <div style="display: flex; justify-content: space-around; gap: 10px;">
              <button id="manual-add-btn">Dodaj račun</button>
              <button id="manual-cancel-btn">Odustani</button>
          </div>
           <p id="manual-entry-error" style="color: red; font-size: 0.9em; margin-top: 10px; display: none;"></p>
      </div>
  </div>

  <div id="pwa-install-modal-overlay">
    <div id="pwa-install-modal-content">
        <h3>Instalirati QR Računator?</h3>
        <p>Na početni zaslon bit će dodana ikona za brzi pristup aplikaciji, bez potrebe za otvaranjem preglednika.</p>
        <div id="pwa-install-modal-buttons">
            <button id="pwa-install-confirm-btn">Da, instaliraj</button>
            <button id="pwa-install-later-btn">Pitaj me kasnije</button>
            <button id="pwa-install-never-btn">Ne, hvala</button>
        </div>
    </div>
  </div>

  <div id="fullscreen-modal" style="display: none;">
      <span id="fullscreen-close">&times;</span>
      <button class="fullscreen-nav prev" id="fullscreen-prev-btn">&lt;</button>
      <div id="fullscreen-content"></div>
      <button class="fullscreen-nav next" id="fullscreen-next-btn">&gt;</button>
      <div id="fullscreen-counter"></div>
  </div>

  <input type="file" id="import-file-input" accept=".json">

  <audio id="scan-sound" src="https://raw.githubusercontent.com/Soboslikar/QR-RACUNATOR/main/novo2.mp3" preload="auto"></audio>
  <audio id="click-sound" src="https://raw.githubusercontent.com/Soboslikar/QR-RACUNATOR/main/click8.mp3" preload="auto"></audio>
  <audio id="remove-sound" src="https://raw.githubusercontent.com/Soboslikar/QR-RACUNATOR/main/smeče.mp3" preload="auto"></audio>
  <audio id="error-sound" src="https://raw.githubusercontent.com/Soboslikar/QR-RACUNATOR/main/error.mp3" preload="auto"></audio>
  <audio id="clear-session-sound" src="https://raw.githubusercontent.com/Soboslikar/QR-RACUNATOR/main/Čiščenje.mp3" preload="auto"></audio>

<script>
    // JavaScript kod će ići u sljedećem bloku
</script>

  <!-- Statcounter kod -->
  <script type="text/javascript"> var sc_project=12702047; var sc_invisible=1; var sc_security="e75d2592"; var scJsHost = "https://"; (function() { var sc = document.createElement('script'); sc.type = 'text/javascript'; sc.async = true; sc.src = scJsHost + "statcounter.com/counter/counter.js"; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(sc, s); })(); </script>
  <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12702047/0/e75d2592/1/" alt="Web Analytics" referrerPolicy="no-referrer-when-downgrade"></a></div></noscript>
  <!-- Kraj Statcounter koda -->

</body>
</html>
